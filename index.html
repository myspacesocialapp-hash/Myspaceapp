<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Space</title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Phosphor Icons -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    
    <!-- FIX: Firebase Imports moved out of type="module" to solve Content Security Policy (CSP) worker-src error -->
    <script src="https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js"></script>

    <!-- NEW: Link to our external CSS file -->
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- This is the main wrapper for the entire application -->
    <div id="app-wrapper">

        <!-- Global loading overlay, shown by default -->
        <div id="loading-overlay" class=""><div class="loader"></div></div>

        <!-- Auth Page: Login & Sign Up -->
        <div id="auth-container" class="page active w-full min-h-screen">
            <!-- Auth content is injected by main.js -->
        </div>

        <!-- Main App Container: Hidden until logged in -->
        <div id="app-container" class="page w-full min-h-screen bg-black">
            <!-- This is where Feed, Profile, etc. will go in Step 2 -->
            <div id="page-content" class="" style="padding-bottom: 80px;">
                <!-- Page content injected by main.js -->
            </div>
        </div>

        <!-- Bottom Navigation Bar: Starts hidden -->
         <nav id="bottom-nav" class="fixed bottom-0 left-0 right-0 w-full max-w-xl mx-auto bg-black border-t border-gray-700 justify-around items-center h-16 hidden">
            <button data-page="feed" class="nav-btn"><i class="ph-bold ph-house"></i><span data-lang-key="nav_feed">Feed</span></button>
            <button data-page="friends" class="nav-btn"><i class="ph-bold ph-users-three"></i><span data-lang-key="nav_friends">People</span></button>
            <button data-page="messages" class="nav-btn relative">
                <i class="ph-bold ph-chats"></i><span data-lang-key="nav_messages">Messages</span>
                <span id="nav-message-badge" class="nav-badge hidden">0</span>
            </button>
            <button data-page="profile" class="nav-btn"><i class="ph-bold ph-user"></i><span data-lang-key="nav_profile">Profile</span></button>
        </nav>


        <!-- All Modals (HTML structure only) -->
        <div id="alert-modal" class="modal hidden">
            <div class="modal-content text-center">
                <p id="alert-message" class="text-lg text-gray-100 mb-6"></p>
                <button id="alert-ok-btn" class="w-full btn btn-primary" data-lang-key="btn_ok">OK</button>
            </div>
        </div>

        <div id="comment-modal" class="modal hidden">
             <div class="modal-content !max-w-md">
                 <h3 class="text-xl font-bold mb-4" data-lang-key="title_comments">Replies</h3>
                 <div id="comment-list" class="max-h-60 overflow-y-auto space-y-3 mb-4 border-t border-b border-gray-700 py-2"></div>
                 <div class="flex space-x-2">
                     <input id="comment-input" type="text" data-lang-key="placeholder_comment" class="flex-1">
                     <button id="comment-submit-btn" class="btn btn-primary px-4">Send</button>
                 </div>
                 <button id="comment-cancel-btn" type="button" class="w-full text-center text-gray-400 mt-4 text-sm link-style" data-lang-key="btn_cancel">Cancel</button>
             </div>
        </div>

        <div id="story-viewer-modal" class="modal hidden !bg-black !bg-opacity-90">
             <button id="story-close-btn" class="absolute top-4 right-4 text-white text-3xl z-10 p-2 bg-black bg-opacity-50 rounded-full">&times;</button>
             <div class="modal-content !bg-transparent !p-0 !shadow-none w-full h-full flex items-center justify-center">
                  <img id="story-image" src="" class="max-w-full max-h-full object-contain rounded-lg">
             </div>
        </div>

        <div id="chat-modal" class="modal hidden">
            <div class="modal-content !p-0 !max-w-md flex flex-col" style="height: 80vh;">
                <div class="flex justify-between items-center p-4 border-b border-gray-700">
                    <h3 id="chat-with-name" class="text-lg font-bold"></h3>
                    <button id="chat-close-btn" class="text-2xl text-gray-400">&times;</button>
                </div>
                <div id="chat-messages" class="flex-1 p-4 overflow-y-auto flex flex-col space-y-3 bg-black"></div>
                <div class="p-4 border-t border-gray-700 flex space-x-2 bg-black">
                    <input id="chat-input" type="text" data-lang-key="placeholder_message" class="flex-1">
                    <button id="chat-send-btn" class="btn btn-primary px-4">Send</button>
                </div>
            </div>
        </div>

        <div id="edit-post-modal" class="modal hidden">
             <div class="modal-content !max-w-md">
                 <h3 class="text-xl font-bold mb-4" data-lang-key="btn_edit">Edit Post</h3>
                 <textarea id="edit-post-input" class="w-full p-2" rows="5"></textarea>
                 <div class="mt-4 flex justify-end space-x-2">
                     <button id="edit-post-cancel-btn" type="button" class="btn btn-secondary" data-lang-key="btn_cancel">Cancel</button>
                     <button id="edit-post-save-btn" class="btn btn-primary" data-lang-key="btn_save">Save</button>
                 </div>
             </div>
        </div>

        <div id="confirm-delete-modal" class="modal hidden">
            <div class="modal-content text-center !max-w-xs">
                <p id="confirm-delete-message" class="text-lg text-gray-100 mb-6"></p>
                <div class="flex justify-center space-x-4">
                     <button id="confirm-delete-cancel-btn" type="button" class="btn btn-secondary" data-lang-key="btn_cancel">Cancel</button>
                     <button id="confirm-delete-confirm-btn" class="btn btn-danger" data-lang-key="btn_delete">Delete</button>
                </div>
            </div>
        </div>

        <div id="forgot-password-modal" class="modal hidden">
             <div class="modal-content !max-w-sm text-center">
                 <h3 class="text-xl font-bold mb-4" data-lang-key="reset_password_title">Reset Password</h3>
                 <p class="text-gray-400 text-sm mb-4" data-lang-key="reset_password_instructions">Enter your email address...</p>
                 <input type="email" id="forgot-email-input" placeholder="Your Email Address" class="w-full mb-4">
                 <p id="forgot-error" class="error-text text-sm h-4 mb-4"></p>
                 <div class="flex flex-col space-y-2">
                      <button id="forgot-send-btn" class="w-full btn btn-primary" data-lang-key="send_reset_link">Send Reset Link</button>
                      <button id="forgot-cancel-btn" type="button" class="w-full text-gray-400 text-sm link-style" data-lang-key="btn_cancel">Cancel</button>
                 </div>
             </div>
        </div>

    </div> <!-- End of app-wrapper -->

    <!-- NEW: Link to our external JS file -->
    <!-- type="module" is important! -->
    <script type="module" src="main.js"></script>

</body>
</html>
